---
title: Authentication Guide
description: 'Complete guide to authenticating with CareerK API'
---

# Authentication Guide

CareerK uses JWT (JSON Web Tokens) for secure authentication. This guide explains how to implement authentication in your frontend application.

## Authentication Flow

<Steps>
  <Step title="Register">User creates an account as Job Seeker or Company</Step>
  <Step title="Email Verification">User receives 6-digit OTP via email and verifies</Step>
  <Step title="Login">User logs in with email and password (for returning users)</Step>
  <Step title="Access Protected Resources">Use access token to make authenticated API calls</Step>
  <Step title="Token Refresh">Automatically refresh expired access tokens</Step>
  <Step title="Password Recovery">Reset forgotten passwords using OTP verification</Step>
</Steps>

## Token Types

### Access Token

- **Lifetime**: 1 hour (3600 seconds)
- **Purpose**: Authenticate API requests
- **Storage**: Store in memory or state management (Redux, Zustand, etc.)
- **Usage**: Include in `Authorization` header

### Refresh Token

- **Lifetime**: 24 hours (86400 seconds)
- **Purpose**: Obtain new access tokens
- **Storage**: HTTP-only cookie (automatically managed by browser)
- **Usage**: Sent automatically with requests to `/auth/refresh-token`

<Warning>
  **Never store tokens in localStorage or sessionStorage** - they are vulnerable to XSS attacks. The
  refresh token is automatically stored in an HTTP-only cookie by the server.
</Warning>

## Implementation Guide

### 1. Register a New User

#### Job Seeker Registration

**Endpoint**: `POST /api/v1/auth/register/job-seeker`

**Request Shape**:

```typescript
interface RegisterJobSeekerDto {
  email: string;
  password: string;
  firstName: string;
  lastName: string;
}
```

**Response Shape**:

```typescript
interface RegisterJobSeekerResponse {
  success: boolean;
  data: {
    email: string;
  };
  message: string;
}
```

#### Company Registration

**Endpoint**: `POST /api/v1/auth/register/company`

**Request Shape**:

```typescript
interface RegisterCompanyDto {
  email: string;
  password: string;
  name: string;
  industry: string;
  size: 'SIZE_1_50' | 'SIZE_51_200' | 'SIZE_201_1000' | 'SIZE_1000_PLUS';
  type: 'STARTUP' | 'SCALE_UP' | 'ENTERPRISE' | 'NON_PROFIT' | 'GOVERNMENT';
}
```

**Response Shape**:

```typescript
interface RegisterCompanyResponse {
  success: boolean;
  data: {
    email: string;
  };
  message: string;
}
```

### 2. Verify Email with OTP

After registration, users receive a 6-digit OTP code via email.

**Endpoint**: `POST /api/v1/auth/verify-email`

**Request Shape**:

```typescript
interface VerifyEmailDto {
  email: string;
  code: string; // 6-digit OTP from email
}
```

**Response Shape**:

```typescript
interface VerifyEmailResponse {
  success: boolean;
  data: {
    id: string;
    email: string;
    firstName?: string; // For job seekers
    lastName?: string; // For job seekers
    name?: string; // For companies
    accessToken: string;
    // ... other user/company fields
  };
  message: string;
}
```

<Note>
  The `credentials: 'include'` option is **required** to allow the browser to store and send the
  HTTP-only refresh token cookie.
</Note>

### 3. Password Reset (Forgot Password)

If a user forgets their password, they can reset it using a two-step process:

#### Step 1: Request Password Reset Code

**Endpoint**: `POST /api/v1/auth/forgot-password`

**Request Shape**:

```typescript
interface ForgotPasswordDto {
  email: string;
}
```

**Response Shape**:

```typescript
interface ForgotPasswordResponse {
  success: boolean;
  data: {
    email: string;
  };
  message: string;
}
```

#### Step 2: Reset Password with OTP

**Endpoint**: `POST /api/v1/auth/reset-password`

**Request Shape**:

```typescript
interface ResetPasswordDto {
  email: string;
  code: string; // 6-digit OTP from email
  newPassword: string;
}
```

**Response Shape**:

```typescript
interface ResetPasswordResponse {
  success: boolean;
  data: {
    message: string;
  };
  message: string;
}
```

#### Step 2: Reset Password with OTP

```javascript
async function resetPassword(email, code, newPassword) {
  const response = await fetch('http://localhost:3000/api/v1/auth/reset-password', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      email: email,
      code: code, // 6-digit OTP from email
      newPassword: newPassword,
    }),
  });

  const result = await response.json();

  if (!response.ok) {
    throw new Error(result.message);
  }

  return result;
  // Returns: { success: true, data: { message: 'Password has been reset successfully' }, ... }
  // All active sessions are logged out - user must login again
}
```

<Warning>
  **All Sessions Logged Out**: After a successful password reset, all active sessions are
  automatically terminated for security. The user must login again with the new password.
</Warning>

### 4. Login (Returning Users)

**Endpoint**: `POST /api/v1/auth/login`

**Request Shape**:

```typescript
interface LoginDto {
  email: string;
  password: string;
}
```

**Response Shape**:

```typescript
interface LoginResponse {
  success: boolean;
  data: {
    id: string;
    email: string;
    firstName?: string; // For job seekers
    lastName?: string; // For job seekers
    name?: string; // For companies
    accessToken: string;
    // ... other user/company fields
  };
  message: string;
}
```

### 5. Making Authenticated Requests

Include the access token in the Authorization header:

```typescript
// Example header
Authorization: Bearer<accessToken>;
```

```typescript
interface AuthRequestHeaders {
  Authorization: `Bearer ${string}`;
  'Content-Type': 'application/json';
}
```

### 6. Refresh Access Token

When the access token expires (after 1 hour), get a new one:

**Endpoint**: `POST /api/v1/auth/refresh-token`

**Request**: No body required (refresh token sent via HTTP-only cookie)

**Response Shape**:

```typescript
interface RefreshTokenResponse {
  accessToken: string;
}
```

## Token Payload Structure

### Access Token Payload

```json
{
  "sub": "550e8400-e29b-41d4-a716-446655440000",
  "email": "user@example.com",
  "type": "JOB_SEEKER",
  "tokenType": "ACCESS",
  "iat": 1705315800,
  "exp": 1705319400,
  "aud": "localhost:3000",
  "iss": "localhost:3000"
}
```

## Security Best Practices

<AccordionGroup>
  <Accordion title="1. Never Store Tokens in localStorage">
    localStorage is vulnerable to XSS attacks. Store access tokens in memory/state and let the browser handle the HTTP-only refresh token cookie.
  </Accordion>

<Accordion title="2. Always Use credentials: 'include'">
  This ensures cookies are sent with cross-origin requests, allowing the refresh token to work
  properly.
</Accordion>

<Accordion title="3. Handle Token Expiration">
  Implement automatic token refresh when you receive a 401 response. This provides a seamless user
  experience.
</Accordion>

<Accordion title="4. Use HTTPS in Production">
  Always use HTTPS in production to prevent token interception. The refresh token cookie has the
  `secure` flag in production.
</Accordion>

  <Accordion title="5. Clear Tokens on Logout">
    Call the logout endpoint (when implemented) and clear all auth state from your application.
  </Accordion>
</AccordionGroup>

## Common Issues

### 401 Unauthorized

**Problem**: Getting 401 errors on authenticated requests

**Solutions**:

- Verify access token is included in Authorization header
- Check token hasn't expired (valid for 1 hour)
- Try refreshing the token
- Re-login if refresh fails

### CORS Errors

**Problem**: CORS errors when making requests

**Solutions**:

- Ensure API URL is correct
- Add `credentials: 'include'` to fetch options
- Verify CORS is configured on the backend for your domain

### Refresh Token Not Working

**Problem**: Can't refresh access token

**Solutions**:

- Ensure `credentials: 'include'` is set on all requests
- Check browser allows third-party cookies
- Verify refresh token hasn't expired (24 hours)
- Check browser console for cookie-related warnings

## Password Reset Flow

<Steps>
  <Step title="User Requests Reset">User clicks "Forgot Password" and submits their email</Step>
  <Step title="OTP Sent">
    If account exists, 6-digit OTP is sent via email (valid for 10 minutes)
  </Step>
  <Step title="User Enters Code">User enters email, OTP code, and new password</Step>
  <Step title="Password Updated">System validates OTP and updates password</Step>
  <Step title="Sessions Invalidated">All active sessions are logged out for security</Step>
  <Step title="User Logs In">User logs in with new password</Step>
</Steps>

## Next Steps

- [Register Job Seeker API](/api-reference/auth/register-job-seeker)
- [Register Company API](/api-reference/auth/register-company)
- [Login API](/api-reference/auth/login)
- [Verify Email API](/api-reference/auth/verify-email)
- [Forgot Password API](/api-reference/auth/forgot-password)
- [Reset Password API](/api-reference/auth/reset-password)
- [Refresh Token API](/api-reference/auth/refresh-token)
